{"version":3,"sources":["webpack:///webpack/bootstrap 3448157241d342aa5a54","webpack:///./dev.js","webpack:///./src/browser.js","webpack:///./src/messager.js","webpack:///./src/EventBus.js","webpack:///./src/native.js"],"names":["RNI","require","native","RNIDev","handle","createNativeInvoke","nativeInvoke","console","warn","window","postMessage","TESTINNERRNI","message","data","JSON","parse","e","type","onMessageHandle","module","exports","factory","innerRNI","post","bind","on","onError","error","stringify","isReadyState","item","messageItem","requestMessageList","id","isWaitPostMessage","onMessage","event","onReady","name","list","key","Object","prototype","hasOwnProperty","call","document","addEventListener","ready","historyLength","history","length","href","location","title","originalPostMessage","defineProperty","get","set","value","setTimeout","createMessager","now","Date","getTime","getUID","noop","Messager","response","requestMessage","sender","fn","status","result","success","Promise","resolve","reject","err","emit","reply","EventBus","eventListeners","cb","fns","indexOf","push","isOnce","idx","splice","newFnArray","forEach","invoke","browserData"],"mappings":"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","file":"RNI.browser.dev.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 3448157241d342aa5a54","var RNI = require('./src/browser');\r\nvar native = require('./src/native');\r\n\r\nfunction RNIDev(handle) {\r\n\tvar createNativeInvoke = native.createNativeInvoke;\r\n\tvar nativeInvoke;\r\n\tconsole.warn(\"RNI is web debug mode.\");\r\n\twindow.postMessage = window.TESTINNERRNI.postMessage = function (message) {\r\n\t\tvar data;\r\n\t\ttry {\r\n\t\t\tdata = JSON.parse(message);\r\n\t\t} catch (e) {\r\n\r\n\t\t}\r\n\t\tif (data && data.type) {\r\n\t\t\tconsole.warn('nativeInvoke.onMessage => ' + data.type);\r\n\t\t}\r\n\t\tnativeInvoke.onMessageHandle({\r\n\t\t\tdata: message\r\n\t\t});\r\n\t};\r\n\r\n\tnativeInvoke = createNativeInvoke(function (message) {\r\n\t\twindow.TESTINNERRNI.onMessageHandle({\r\n\t\t\tdata: message\r\n\t\t});\r\n\t});\r\n\twindow['originalPostMessage'] = function () {\r\n\r\n\t};\r\n\thandle(nativeInvoke);\r\n};\r\n\r\nwindow.RNIDev = RNIDev;\r\n\r\nmodule.exports = RNIDev;\r\n\n\n\n// WEBPACK FOOTER //\n// ./dev.js","import { createMessager } from './messager';\nlet RNI = window.RNI;\n(function (factory) {\n\tif (!RNI) {\n\t\tlet innerRNI = factory();\n\t\tRNI = {\n\t\t\tpost: innerRNI.post.bind(innerRNI),\n\t\t\ton: innerRNI.on.bind(innerRNI),\n\t\t\t// once: innerRNI.once.bind(innerRNI),\n\t\t\t// off: innerRNI.off.bind(innerRNI),\n\t\t\tonError: function (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t};\n\n\t\tinnerRNI.onError = function (e) {\n\t\t\twindow.RNI.onError && window.RNI.onError(`RNI error response:${JSON.stringify(e)}`, e);\n\t\t};\n\t\twindow.RNI = RNI;\n\t\twindow.TESTINNERRNI = innerRNI;\n\t}\n})\n(function () {\n\tfunction postMessage(message) {\n\t\tif (this.isReadyState) {\n\t\t\twindow.postMessage(message);\n\t\t} else {\n\t\t\tlet item = JSON.parse(message);\n\t\t\tlet messageItem = this.requestMessageList[item.id];\n\t\t\tmessageItem.isWaitPostMessage = true;\n\t\t}\n\t};\n\n\tfunction onMessage(event) {\n\n\t};\n\n\tRNI = createMessager(postMessage, onMessage, function onReady(e) {\n\t\tthis.name = 'browser';\n\n\t\tlet list = this.requestMessageList;\n\n\t\tfor (let key in list) {\n\t\t\tif (!Object.prototype.hasOwnProperty.call(list, key)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet item = list[key];\n\t\t\tif (item.isWaitPostMessage) {\n\t\t\t\tthis.postMessage(JSON.stringify(item.message));\n\t\t\t\tdelete item.isWaitPostMessage;\n\t\t\t}\n\t\t}\n\n\t});\n\tdocument.addEventListener('message', RNI.onMessageHandle.bind(RNI));\n\n\tfunction ready() {\n\t\twindow.postMessage(JSON.stringify({\n\t\t\tid: 0,\n\t\t\ttype: \"ready\",\n\t\t\tdata: {\n\t\t\t\thistoryLength: window.history.length,\n\t\t\t\thref: window.location.href,\n\t\t\t\ttitle: document.title,\n\t\t\t}\n\t\t}));\n\t}\n\n\tlet originalPostMessage = window['originalPostMessage'];\n\tif (originalPostMessage) {\n\t\tready()\n\t} else {\n\t\tObject.defineProperty(window, 'originalPostMessage', {\n\t\t\tget: function () {\n\t\t\t\treturn originalPostMessage\n\t\t\t},\n\t\t\tset: function (value) {\n\t\t\t\toriginalPostMessage = value;\n\t\t\t\tif (originalPostMessage) {\n\t\t\t\t\tsetTimeout(ready, 50);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\treturn RNI;\n});\n\nexport default RNI;\n\n\n\n// WEBPACK FOOTER //\n// ./src/browser.js","import EventBus  from './EventBus';\n\nlet now = new Date().getTime();\nfunction getUID() {\n\treturn ++now;\n}\n\nfunction noop() {\n\n}\n\nclass Messager extends EventBus {\n\n\tconstructor(postMessage, onMessage, onReady) {\n\t\tsuper();\n\t\tthis.isReadyState = false;\n\t\tthis.requestMessageList = [];\n\n\t\t// this.eventBus = new EventBus();\n\n\t\tthis.on('ready', function (e) {\n\t\t\tthis.isReadyState = true;\n\t\t\tonReady && onReady.bind(this)(e);\n\t\t}.bind(this));\n\n\t\tthis.on('reply', function (response) {\n\t\t\tlet requestMessage = this.requestMessageList[response.sender] || {};\n\t\t\tlet fn = requestMessage[response.status];\n\t\t\tfn && fn(response.result)\n\t\t\tif (response.status == 'error') {\n\t\t\t\tthis.onError && this.onError(response);\n\t\t\t}\n\t\t\tdelete this.requestMessageList[response.sender];\n\t\t}.bind(this));\n\n\t\tthis.postMessage = postMessage || noop;\n\n\t\tthis.onMessage = onMessage || noop;\n\n\t}\n\n\tpostMessage() {\n\n\t}\n\n\tonMessage() {\n\n\t}\n\n\tisReady() {\n\t\treturn this.isReadyState;\n\t}\n\n\tpost(type, success, error) {\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\tlet data;\n\t\t\tif (typeof type === 'string') {\n\t\t\t\tdata = {\n\t\t\t\t\ttype,\n\t\t\t\t};\n\t\t\t} else if (type.type) {\n\t\t\t\tdata = type;\n\t\t\t}\n\n\t\t\tdata.id = getUID();\n\t\t\tlet messageItem = {\n\t\t\t\tmessage: data,\n\t\t\t\tsuccess:function(result){\n\t\t\t\t\tsuccess && success(result);\n\t\t\t\t\tresolve(result);\n\t\t\t\t},\n\t\t\t\terror:function(err){\n\t\t\t\t\terror && error(err);\n\t\t\t\t\treject(err);\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.requestMessageList[data.id] = messageItem;\n\t\t\tthis.postMessage(JSON.stringify(data));\n\t\t}.bind(this));\n\t}\n\n//\ton(eventType, handle) {\n\t// if (this.eventBus.eventListeners[eventType]) {\n\t// \tthrow Error(`event ${eventType}  repeat binding`);\n\t// }\n\t//this.eventBus.addEventListener(eventType, handle);\n//\t}\n\n\t/*\n\t off(eventType, handle) {\n\t this.eventBus.removeEventListener(eventType, handle);\n\t }\n\t */\n\treply(sender, status, result) {\n\t\ttry {\n\t\t\tthis.postMessage(JSON.stringify({\n\t\t\t\tsender,\n\t\t\t\tstatus,\n\t\t\t\tresult,\n\t\t\t}));\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t}\n\n\tonMessageHandle(e) {\n\t\ttry {\n\t\t\tlet data = JSON.parse(e.data);\n\t\t\tif (data.sender) {\n\t\t\t\tthis.emit('reply', data);\n\t\t\t} else if (data.type) {\n\t\t\t\tdata.success = this.reply.bind(this, data.id, 'success');\n\t\t\t\tdata.error = this.reply.bind(this, data.id, 'error');\n\t\t\t\tthis.emit(data.type, data);\n\t\t\t}\n\t\t\tthis.onMessage(e);\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t}\n}\n\nexport function createMessager(postMessage, onMessage, onReady) {\n\treturn new Messager(postMessage, onMessage, onReady);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/messager.js","export default class EventBus {\n\tconstructor() {\n\t\tthis.eventListeners = {};\n\t}\n\n\ton(name, cb) {\n\t\tconst fns = this.eventListeners[name] || [];\n\t\tif (fns.indexOf(cb) < 0) {\n\t\t\tfns.push(cb);\n\t\t}\n\t\tthis.eventListeners[name] = fns;\n\t}\n\n\tonce(name, cb) {\n\t\tcb.isOnce = true;\n\t\tthis.on(name, cb);\n\t}\n\n\toff(name, cb) {\n\t\tconst fns = this.eventListeners[name] || [];\n\t\tif (cb) {\n\t\t\tconst idx = fns.indexOf(cb)\n\t\t\tif (idx >= 0) {\n\t\t\t\tfns.splice(idx, 1);\n\t\t\t}\n\t\t} else {\n\t\t\tdelete this.eventListeners[name];\n\t\t}\n\t}\n\n\temit(name, event) {\n\t\tconst fns = this.eventListeners[name] || [];\n\t\tif (fns.length == 0) {\n\t\t\t//console.warn(`no find event type ${name}...`);\n\t\t\treturn;\n\t\t}\n\t\tlet newFnArray = [];\n\t\tfns.forEach(function (fn) {\n\t\t\tfn(event);\n\t\t\tif (!fn.isOnce) {\n\t\t\t\tnewFnArray.push(fn);\n\t\t\t}\n\t\t});\n\n\t\tthis.eventListeners[name] = newFnArray;\n\t}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/EventBus.js","import { createMessager } from './messager';\n\nexport function createNativeInvoke(postMessage) {\n\n\tlet invoke = createMessager(postMessage, function onMessage(event) {\n\n\t}, function onReady(e) {\n\t\tthis.name = 'native';\n\t\tthis.postMessage(JSON.stringify({ id: 0, type: \"ready\" }));\n\t\tthis.browserData = e.data;\n\t});\n\n\treturn invoke;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/native.js"],"sourceRoot":""}